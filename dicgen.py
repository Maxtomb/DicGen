#!/usr/bin/python

import sys
import random
import json
import getopt
import traceback
import copy

def main(argv):
    letterScope = '0530-058F,10530-1056F,10530-1056F,10800-1083F,0400-052F,10500-1052F,10A0-10FF,2C00-2C5F,10330-1034F,0370-03FF,0000-02AF,10600-1077F,10000-1013F,1680-169F,10C80-10CFF,10300-1032F,10350-1037F,101D0-101FF,16A0-16FF,10450-1047F,A700-A71F,02B0-02FF,2070-209F,0300-036F,20D0-20FF,FE20-FE2F,1E900-1E95F,A6A0-A6FF,16AD0-16AFF,03E2-03EF,13000-1342F,1200-139F,1E800-1E8DF,10980-109FF,07C0-07FF,10480-104AF,2D30-2D7F,A500-A63F,14400-1467F,0600-06FF,10840-1085F,10B00-10B3F,102A0-102DF,10380-103DF,108E0-108FF,0590-05FF,10280-1029F,10920-1093F,0840-085F,10880-108AF,10A80-10A9F,10A60-10A7F,10B60-10B7F,10B80-10BAF,10860-1087F,10B40-10B5F,10900-1091F,0800-083F,0700-074F,10AC0-10AFF,11C70-11CBF,1800-18AF,10C00-10C4F,A840-A87F,0F00-0FFF,11700-1173F,0980-09FF,11C00-11C6F,11000-1107F,11100-1114F,0900-097F,11300-1137F,0A80-0AFF,0A00-0A7F,11080-110CF,0C80-0CFF,10A00-10A5F,11200-1124F,112B0-112FF,1C00-1C4F,1900-194F,11150-1117F,0D00-0D7F,AAE0-AAFF,11600-1165F,16A40-16A6F,11280-112AF,11400-1147F,1C50-1C7F,0B00-0B7F,A880-A8DF,11180-111DF,11580-115FF,0D80-0DFF,110D0-110FF,A800-A82F,11680-116CF,0B80-0BFF,0C00-0C7F,0780-07BF,11480-114DF,1CD0-1CFF,118A0-118FF,AA00-AA5F,A900-A92F,1780-17FF,0E80-0EFF,1000-109F,1980-19DF,16B00-16B8F,11AC0-11AFF,1950-197F,1A20-1AAF,AA80-AADF,0E00-0E7F,1B00-1B7F,1BC0-1BFF,1A00-1A1F,1740-175F,1720-173F,A980-A9DF,A930-A95F,1B80-1BBF,1700-171F,1760-177F,3100-312F,3400-4DBF,F900-FAFF,2E80-2FDF,1100-11FF,AC00-D7AF,3040-309F,30A0-30FF,3190-319F,A4D0-A4FF,16F00-16F9F,17000-18AFF,A000-A4CF,13A0-13FF,10400-1044F,104B0-104FF,1400-167F,FB00-FB4F,0000-007F,FF00-FFEF,2800-28FF,1D000-1D24F,1BC00-1BCAF,1D800-1DAAF,0021-007F,3000-303F,FE10-FE1F,2100-214F,1D400-1D7FF,1EE00-1EEFF,2460-24FF,3200-32FF,2100-214F,2336-237A,2400-243F,2300-23FF,2440-245F,0030-0039,A830-A83F,102E0-102FF,1D360-1D37F,12400-1247F,2150-218F,10E60-10E7F,111E0-111FF,2070-209F,2190-21FF,2100-214F,0000-00FF,2500-25FF,2700-27BF,1F600-1F64F,2600-26FF,1F300-1F5FF,1F900-1F9FF,1F680-1F6FF,1F700-1F77F,10190-101CF,2616-2617,2B00-2BFF,2630-2637,0010-001F,2000-206F,2061-2064,FFF0-FFFF,FB00-FB4F,1C80-1C8F,2D00-2D2F,1E000-1E02F,1F00-1FFF,1E00-1DBF,1AB0-1AFF,16800-16A3F,2C80-2CFF,2D80-2DDF,0750-077F,12000-1254F,FB1D-FB4F,11660-1167F,A8E0-A8FF,ABC0-ABFF,111E0-111FF,19E0-19FF,A9E0-A9FF,1CC0-1CCF,31A0-31BF,4E00-9FFF,2F800-2FA1F,2FF0-2FFF,3130-318F,31F0-31FF,AB70-ABBF,18B0-18FF,00A1-00BF,16FE0-16FFF,FE30-FE6F,10190-101CF,1F100-1F1FF,1F200-1F2FF,3300-33FF,FF10-FF19,27F0-27FF,1D400-1D7FF,2061-2064,2B00-2BFF,1F650-1F67F,00A2-00A5,2654-2667,268A-268F,0080-009F,FFFE-FFFF,2DE0-2DFF,10140-1018F,2C60-2C7F,1DC0-1DFF,102E0-102FF,AB00-AB2F,08A0-08FF,AA60-AA7F,20000-2A6DF,31C0-31EF,A960-A97F,FF65-FF9F,2000-206F,FF00-FFEF,2900-297F,1EE00-1EEFF,2200-22FF,1F780-1F7FF,26C0-26C3,4DC0-4DFF,A640-A69F,A720-A7FF,FB50-FDFF,2A700-2CEAF,D7B0-D7FF,1B000-1B0FF,2E00-2E7F,2B00-2BFF,2308-230B,1F000-1F0FF,1D300-1D35F,AB30-AB6F,FE70-FEFF,FFA0-FFDC,1F800-1F8FF,27C0-27EF,20A0-20CF,FB00-FB06,2980-2AFF,FF00-FF5E'
    outputfile = '/tmp/dict.json'
    isHex = True 

    try:
	opts, args = getopt.getopt(argv,"hs:f:x:",["scope=","file=","hexScope="])
    except getopt.GetoptError:
	print 'dicgen.py -s <letter_scope1,letter_scope2,...> -f <outputfile>'
	sys.exit(2)
    for opt, arg in opts:
	if opt == '-h':
	    print '-s --scope  Specify a scope in Unicode to generate into the dictionary. Example: <10-15,20-50,...>' 
	    print '-x --hexScope Specify a scope with hex string to generate the dictionary'
	    print '-f --file   Specify the full path of the dictionary'
	    sys.exit()
	elif opt in ("-s","--scope"):
	    letterScope = arg
	elif opt in ("-f","--file"):
	    outputfile = arg
	elif opt in ("-x","--hexScope"):
	    isHex = True
	    letterScope = arg
    params = letterScope.split(',')

    shuffleList = range(524288)
    decodeList = copy.deepcopy(shuffleList)

    for param in params:
	scopePs = param.split('-')
	if isHex == True:
	    arr = shuffleList[int('0x'+scopePs[0],16):int('0x'+scopePs[1],16)]
	    random.shuffle(arr)
	    shuffleList[int('0x'+scopePs[0],16):int('0x'+scopePs[1],16)] = arr
	else:
	    ark = shuffleList[int(scopePs[0]):int(scopePs[1])]
	    random.shuffle(ark)
	    shuffleList[int(scopePs[0]):int(scopePs[1])] = ark
    
    dic3 = {"decode":decodeList,"encode":shuffleList}
    writeToFile(outputfile,json.dumps(dic3))

def writeToFile(filePath,content):
    f = file(filePath,'w')
    f.writelines(content)
    f.close()

if __name__ == "__main__":
    main(sys.argv[1:])
